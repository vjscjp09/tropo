image: mikejihbe/nodejs-ssh:latest
git:
  path: github.com/CiscoCloud/tropo
script:
  - echo "build commands"
  - npm install
  - echo "Tests Passed"
clone:
  path: github.com/CiscoCloud/tropo
build:
  image: mikejihbe/nodejs-ssh:latest
  commands:
    - echo "build commands"
    - npm install
    - echo "Tests Passed"
publish:
  docker:
    dockerfile: ./Dockerfile
    docker_host: 10.10.10.15:2375
    docker_version: 1.4.1
    registry_login_url: $$bintray_repo_login_url
    registry_login: true
    username: $$bintray_user
    password: $$bintray_api_key
    email: $$bintray_user_email
    image_name: $$bintray_image_name
    push_latest: true
    tag: $$COMMIT
    
    registry: $$bintray_registry
    repo: $$bintray_repo
notify:
  webhook:
    image: shippedrepos-docker-drone.bintray.io/drone-webhook
    urls:
      - "http://shipped-api.tx3.shipped-cisco.com/webhooks/drone"
    on_success: true
    on_failure: true
